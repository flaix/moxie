<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- Begin Header -->
<title>Moxie</title>
<meta charset="utf-8">
<meta name="ROBOTS" content="INDEX">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
<link rel="stylesheet" href="./bootstrap/css/bootstrap.css">
<link rel='shortcut icon' type='image/png' href='./moxie-favicon.png' />
<link rel="stylesheet" href="./prettify/googlecode.css" /><link rel="alternate" type="application/rss+xml" title="Moxie RSS 2.0" href="./rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Moxie Atom" href="./atom.xml" />

<!-- Google Plus One -->
<link rel="canonical" href="http://moxie.gitblit.com" />
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
<style type="text/css"> div.gplusone { margin-top:12px; } </style>

<script src="./prettify/prettify.js"></script>
<script src="./bootstrap/js/jquery.js"></script>
<script src="./bootstrap/js/bootstrap.min.js"></script>
</head>
<body onload='prettyPrint()'>		<!-- Navigation Bar -->
		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
          			<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            			<span class="icon-bar"></span>
            			<span class="icon-bar"></span>
            			<span class="icon-bar"></span>
          			</a>
          			<a class="brand" href="./"><img src="./moxie.png" alt="Moxie"></img></a>
					<div class="nav-collapse">
						<ul class="nav">
							<li class='dropdown'> <!-- Menu -->
<a class='dropdown-toggle' href='#' data-toggle='dropdown'>about<b class='caret'></b></a>
<ul class='dropdown-menu'>
<li><a href='index.html'>overview</a></li>
<li><a href='why.html'>why?!</a></li>
<li><a href='design.html'>design</a></li>
</ul></li> <!-- End Menu -->
<li class='dropdown'> <!-- Menu -->
<a class='dropdown-toggle' href='#' data-toggle='dropdown'>documentation<b class='caret'></b></a>
<ul class='dropdown-menu'>
<li><a href='gettingstarted.html'>getting started</a></li>
<li><a href='moxiedescriptor.html'>build.moxie</a></li>
<li><a href='defaults.html'>defaults.moxie</a></li>
<li><a href='settings.html'>settings.moxie</a></li>
<li><a href='samples.html'>sample files</a></li>
<li><a href='tipsandtricks.html'>tips & tricks</a></li>
<li><a href='properties.html'>ant property reference</a></li>
</ul></li> <!-- End Menu -->
<li class='dropdown'> <!-- Menu -->
<a class='dropdown-toggle' href='#' data-toggle='dropdown'>tasks<b class='caret'></b></a>
<ul class='dropdown-menu'>
<li class='dropdown-submenu'> <!-- Submenu -->
<a tabindex='-1' href='#'>core tasks</a>
<ul class='dropdown-menu'>
<li><a href='mxinit.html'>mx:Init</a></li>
<li><a href='mxreport.html'>mx:Report</a></li>
<li><a href='mxget.html'>mx:Get</a></li>
</ul></li> <!-- End Submenu -->
<li class='dropdown-submenu'> <!-- Submenu -->
<a tabindex='-1' href='#'>all tasks</a>
<ul class='dropdown-menu'>
<li><a href='mxclean.html'>mx:Clean</a></li>
<li><a href='mxdeploy.html'>mx:Deploy</a></li>
<li><a href='mxdoc.html'>mx:Doc</a></li>
<li><a href='mxextract.html'>mx:Extract</a></li>
<li><a href='mxftp.html'>mx:Ftp</a></li>
<li><a href='mxgcupload.html'>mx:GCUpload</a></li>
<li><a href='mxgenjar.html'>mx:GenJar</a></li>
<li><a href='mxget.html'>mx:Get</a></li>
<li><a href='mxghpages.html'>mx:GhPages</a></li>
<li><a href='mxgroovy.html'>mx:Groovy</a></li>
<li><a href='mxcommitid.html'>mx:CommitId</a></li>
<li><a href='mxcommit.html'>mx:Commit</a></li>
<li><a href='mxif.html'>mx:If</a></li>
<li><a href='mxinit.html'>mx:Init</a></li>
<li><a href='mxinstall.html'>mx:Install</a></li>
<li><a href='mxjar.html'>mx:Jar</a></li>
<li><a href='mxjavac.html'>mx:Javac</a></li>
<li><a href='mxjavadoc.html'>mx:Javadoc</a></li>
<li><a href='mxkeys.html'>mx:Keys</a></li>
<li><a href='mxonejar.html'>mx:OneJar</a></li>
<li><a href='mxreport.html'>mx:Report</a></li>
<li><a href='mxrun.html'>mx:Run</a></li>
<li><a href='mxtar.html'>mx:Tar</a></li>
<li><a href='mxtest.html'>mx:Test</a></li>
<li><a href='mxthumbs.html'>mx:Thumbs</a></li>
<li><a href='mxversion.html'>mx:Version</a></li>
<li><a href='mxwar.html'>mx:War</a></li>
<li><a href='mxwebxml.html'>mx:WebXml</a></li>
<li><a href='mxzip.html'>mx:Zip</a></li>
</ul></li> <!-- End Submenu -->
</ul></li> <!-- End Menu -->
<li><a href='moxie+ant.html'>moxie+ant</a></li>
<li><a href='proxy.html'>proxy</a></li>
<li><a href='maxml.html'>maxml</a></li>
<li><a href='releasenotes.html'>release notes</a></li>
<li class='dropdown'> <!-- Menu -->
<a class='dropdown-toggle' href='#' data-toggle='dropdown'>downloads<b class='caret'></b></a>
<ul class='dropdown-menu'>
<li><a href='http://gitblit.github.io/moxie/maven/org/moxie/moxie-toolkit/0.9.1/moxie-toolkit-0.9.1-core.jar'>moxie toolkit (core)</a></li>
<li><a href='http://gitblit.github.io/moxie/maven/org/moxie/moxie-toolkit/0.9.1/moxie-toolkit-0.9.1.jar'>moxie toolkit</a></li>
<li class='divider'></li>
<li><a href='http://gitblit.github.io/moxie/maven/org/moxie/moxie-proxy/0.9.1/moxie-proxy-0.9.1.zip'>moxie-proxy</a></li>
<li class='divider'></li>
<li><a href='http://gitblit.github.io/moxie/maven/org/moxie/moxie+ant/0.9.1/moxie+ant-0.9.1.zip'>moxie+ant (zip)</a></li>
<li><a href='http://gitblit.github.io/moxie/maven/org/moxie/moxie+ant/0.9.1/moxie+ant-0.9.1.tar.gz'>moxie+ant (tar.gz)</a></li>
<li class='divider'></li>
<li><a href='http://github.com/gitblit/moxie'>Github Project</a></li>
<li class='divider'></li>
<li><a href='http://gitblit.github.io/moxie/maven'>Maven Repository</a></li>
</ul></li> <!-- End Menu -->
<li class='divider-vertical'></li>
<li><div class='gplusone'><g:plusone size='small' href='http://moxie.gitblit.com'></g:plusone></div></li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div><!-- end Navigation Bar -->
<div class='container'>
<!-- Begin Markdown -->
<h2 class="section" id='H1'><a href="#H1" class="sectionlink"><i class="icon-share-alt"> </i></a>Design</h2><p>Be just enough. Be useful. Don't overreach. Don't impose. <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" title="Don&#39;t Repeat Yourself">Don't Repeat Yourself</a>.</p><p>Moxie is not designed to be Maven. It is designed to be an Ant enhancement for a Maven-dominated world.</p>
<h3 class="section" id='H2'><a href="#H2" class="sectionlink"><i class="icon-share-alt"> </i></a>Dependency Management</h3><p>Moxie does <em>not</em> use <a href="http://ant.apache.org/ivy" title="Apache Ivy">Ivy</a> nor <a href="http://maven.apache.org" title="Apache Maven">Maven</a> to retrieve artifacts or to solve transitive dependencies. It has it's own solution engine written based on the Maven, Ivy, and Gradle documentation.</p><p>Moxie employs a two-pass solver which is executed for each scope (compile, test, etc).</p>
<ol>
  <li>The first pass retrieves POMs for all dependencies regardless of scope by walking up and down the dependency graph.</li>
  <li>The second pass generates the complete tree of resolved artifacts and then employs the <em>nearest</em> rule to eliminate duplicates in the graph.</li>
</ol>
<h3 class="section" id='H3'><a href="#H3" class="sectionlink"><i class="icon-share-alt"> </i></a>Dependency Resolution</h3><p>To improve the efficiency of dependency resolution, Moxie uses the following information sources to re-order your repositories, per-dependency, to hopefully download the dependency from the first repository contacted:</p>
<ol>
  <li>manually defined <em>groupId</em> affinities</li>
  <li>known origin urls (primarily used for metadata and SNAPSHOT updates)</li>
  <li>repository <em>.meta/prefixes.txt</em>, offered by some Maven repositories</li>
  <li>user-defined order in <em>repositories</em> setting</li>
</ol>
<h3 class="section" id='H4'><a href="#H4" class="sectionlink"><i class="icon-share-alt"> </i></a>Version Ranges</h3><p>Version ranges are the ugly duckling of Moxie. They are only partially supported. Maven (Aether) has a very sophisticated mechanism for dealing with version ranges which Moxie will never attempt to reproduce. IMHO version ranges are an unnecessary implementation complexity.</p><p>When confronted with a version range specification, Moxie will resolve the highest version it can by consulting the maven-metadata.xml file. Moxie does not consult the entire dependency graph during version range resolution. This is a gross-simplification of the Maven version range feature.</p>
<h3 class="section" id='H5'><a href="#H5" class="sectionlink"><i class="icon-share-alt"> </i></a>Moxie Root Directory</h3><p>By default, Moxie stores it's retrieved artifacts and metadata in <code>${user.home}/.moxie</code>.</p><p>The directory structure takes design elements from both Maven and Gradle. Despite my preference for Gradle's <em>groupId</em> directory structure (org.apache.ant/ant/1.8.4), the Maven 2 directory structure was adopted (org/apache/ant/ant/1.8.4) because it allows direct http or ftp serving of those folders to a Maven 2-compatible client. This is exploited by Moxie Proxy, which can serve any Moxie root directory.</p><p>A typical Moxie root directory structure may look something like the following:<br/><pre>[data]
  +--[com]
  +--[org]
  +--[commons-io]
    +--[commons-io]
       +--[2.2]
          -metadata.moxie
[local]
  +--[releases]
  +--[snapshots]
[lucene]
  +--[central]
  +--[releases]
  +--[restlet]
[remote]
  +--[maven.restlet.org]
  +--[repo1.maven.org_maven2]
    +--[commons-io]
      +--[commons-io]
        +--[2.2]
           -commons-io-2.2.pom
           -commons-io-2.2.pom.sha1
           -commons-io-2.2.jar
           -commons-io-2.2.jar.sha1
-moxie-toolkit-0.7.0.jar
-moxie-toolkit-0.7.1.jar
-moxie-toolkit-0.7.2.jar
</pre></p>
<dl>
	<dt>data</dt><dd>directory where Moxie stores Moxie metadata about an artifact: it's origin, record keeping dates, solved transitive dependencies, etc</dd>
	<dt>local</dt><dd>directory where artifacts you build are installed based on their release status<br/>directory where artifacts are copied to when using the <b>COPY</b> Maven cache strategy to re-use <em>${user.home}/.m2/repository</em> artifacts</dd>
	<dt>lucene</dt><dd>directory where Lucene indexes are maintained, per-registered repository<br/><i>only applies to Moxie Proxy</i></dd>
	<dt>remote</dt><dd>directory where retrieved artifacts and standard Maven metadata files are stored, per-repository</dd>
</dl>
<h3 class="section" id='H6'><a href="#H6" class="sectionlink"><i class="icon-share-alt"> </i></a>Reference links</h3>
<ul>
  <li><a href="http://www.sonatype.com/people/2009/12/maven-dependency-resolution-a-repository-perspective">Maven dependency resolution</a></li>
  <li><a href="http://docs.codehaus.org/display/MAVEN/Repository+-+SNAPSHOT+Handling">Maven SNAPSHOT resolution</a></li>
  <li><a href="https://maven.apache.org/pom.html" title="Apache Maven POM Reference">Maven's POM XML config file reference</a></li>
  <li><a href="http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-properties.html">Maven properties reference</a></li>
  <li><a href="https://cwiki.apache.org/MAVEN/maven-3x-compatibility-notes.html">Maven 3 Compatibility Notes</a></li>
  <li><a href="http://maven.apache.org/ref/3.0.3/maven-settings/settings.html">Maven settings.xml reference</a></li>
  <li><a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">Maven LifeCycle reference</a></li>
  <li><a href="https://ant.apache.org/ivy/history/latest-milestone/ivyfile.html" title="Apache Ivy File Reference">Ivy's XML config file reference</a></li>
  <li><a href="https://ant.apache.org/ivy/history/trunk/concept.html" title="Apache Ivy Main Concepts">Ivy Main Concepts</a></li>
  <li><a href="http://forums.gradle.org/gradle/topics/improved_gradle_dependency_cache">Gradle Cache Design</a></li>
</ul>
<!-- End Markdown -->
<div ><ul class="pager"><li class="previous"><a href="why.html">&larr; why?!</a></li> </ul></div><footer class="footer"><p class="pull-right">generated 2013-11-29</p>
<p>The content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0">Creative Commons Attribution 3.0 License</a>.</p>
</footer>
</div>
</body>
</html>